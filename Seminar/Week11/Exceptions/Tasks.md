# Задачи за работа с изключения в C++

## Задача 1: Валидация на вход

Напишете функция `validateInput`, която проверява дали подаден низ съдържа валидно цяло число между определени граници. Ако низът не е число, функцията трябва да хвърля `std::invalid_argument`. Ако числото е извън зададените граници, функцията трябва да хвърля `std::out_of_range`.

```cpp
int validateInput(const std::string& input, int min, int max);
```

## Задача 2: Клас за работа с файл

Създайте клас `SafeFile`, който прилага RAII принципа за безопасна работа с файлове:

1. Конструкторът отваря файл и хвърля изключение, ако файлът не може да бъде отворен
2. Деструкторът автоматично затваря файла
3. Класът трябва да предоставя методи за четене и писане във файла, които хвърлят подходящи изключения при грешка

## Задача 3: Собствена йерархия от изключения

Създайте йерархия от изключения за онлайн магазин:

1. Базов клас `ShopException`, наследяващ `std::runtime_error`
2. Производни класове:
   - `ProductNotFoundException`
   - `InsufficientStockException`
   - `PaymentFailedException`

Всеки клас трябва да съдържа подходяща допълнителна информация (напр. ID на продукт, необходимо количество и т.н.)

## Задача 4: Обработка на изключения от стандартната библиотека

Напишете програма, която:

1. Чете числа от текстов файл
2. Изчислява сумата и средната стойност
3. Записва резултата в друг файл

Програмата трябва да обработва всички възможни изключения (проблеми с файла, грешки при преобразуване и т.н.) и да предоставя ясни съобщения за грешки.

## Задача 5: Функция за безопасно заделяне на памет

Напишете шаблонна функция `safeMalloc`, която:

1. Заделя памет за масив от тип T с определен размер
2. Обработва и прехвърля изключение `std::bad_alloc` с допълнителна информация за размера на заявената памет
3. Гарантира, че няма изтичане на памет при хвърляне на изключение

```cpp
template<typename T>
T* safeMalloc(size_t count);
```

## Задача 6: Класове с изключения и noexcept

Създайте клас `Complex` за комплексни числа със следните характеристики:

1. Конструкторите и деструкторът трябва да бъдат обявени като `noexcept`
2. Аритметичните операции (`+`, `-`, `*`, `/`) трябва да хвърлят изключения при нужда (напр. деление на нула)
3. Методите за достъп до реалната и имагинерната част трябва да бъдат `noexcept`

## Задача 7: Обработка на грешки при многонишково програмиране

Напишете програма, която създава няколко нишки, всяка от които:

1. Опитва се да отвори и прочете различен файл
2. Улавя изключения, възникнали при четенето
3. Записва информация за грешката в споделен лог

Програмата трябва да изчака всички нишки да завършат и да покаже обобщена информация за грешките.

## Задача 8: Преобработване на изключения

Напишете клас `DatabaseConnection`, който:

1. При създаване се свързва с база данни (симулирайте процеса)
2. Има метод `executeQuery`, който може да хвърля различни видове изключения
3. Преобработва всички низкоуровневи изключения в по-информативни такива, специфични за базата данни

## Задача 9: Изключения и наследяване

Създайте йерархия от класове `Shape`, `Circle`, `Rectangle`, които:

1. Имат виртуален метод `calculateArea()`, който може да хвърля изключения
2. Класовете-наследници преопределят този метод, като спазват принципа, че производен клас не може да хвърля повече видове изключения от базовия

## Задача 10: Проект "Банкова система"

Разработете проста банкова система със следните компоненти:

1. Клас `BankAccount` с методи за депозит и теглене
2. Клас `Bank`, управляващ множество сметки
3. Собствена йерархия от изключения за различни банкови грешки
4. Прилагане на RAII принципа за всички ресурси
5. Подходяща обработка на изключения във всички нива на програмата

### Бонус задачи

## Бонус задача 1: Stack Unwinding

Напишете програма, която демонстрира процеса "stack unwinding" при хвърляне на изключение. Програмата трябва да има няколко нива на вложени функции, всяка със собствени локални обекти. Използвайте съобщения в конструкторите и деструкторите, за да покажете реда на създаване и унищожаване на обектите.

## Бонус задача 2: Exception safety гаранции

Създайте клас `Vector`, който имплементира опростен вектор с динамично заделена памет. Имплементирайте различни методи с различни нива на гаранции за безопасност при изключения:
- Базова гаранция (basic guarantee)
- Силна гаранция (strong guarantee)
- Без хвърляне на изключения (no-throw guarantee)

## Бонус задача 3: Асинхронна обработка на изключения

Използвайте `std::future` и `std::promise` за създаване на асинхронни операции, които могат да хвърлят изключения. Демонстрирайте как изключение, хвърлено в една нишка, може да бъде уловено в друга.